<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Mon Aug 28 10:11:38 2023 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
       pre { margin-left: 8px; margin-top: 0; margin-bottom: 0; vertical-align: top; }
       body { background-color: #202020; color: white; 
              font-family: Monospace; font-weight: 400;  
              font-size: 12pt; margin-right: 16px;     }
</style>
<title>MOUNT.CIFS, MOUNT.SMB3</title>

</head>
<body>

<h1 align="center">MOUNT.CIFS, MOUNT.SMB3</h1>

<p style="margin-left:9%; margin-top: 1em">mount.cifs,
mount.smb3 &minus; mount using the Common Internet File
System (CIFS)</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:13%; margin-top: 1em">mount.cifs
{service} {mount&minus;point} [&minus;o options]</p>

<p style="margin-left:9%; margin-top: 1em">This tool is
part of the cifs&minus;utils suite.</p>


<p style="margin-left:9%; margin-top: 1em"><b>mount.cifs</b>
mounts a CIFS or SMB3 filesystem from Linux. It is usually
invoked indirectly by the mount(8) command when using the
&quot;&minus;t cifs&quot; option. This command only works in
Linux, and the kernel must support the cifs filesystem. The
SMB3 protocol is the successor to the CIFS (SMB) protocol
and is supported by most Windows servers, Azure (cloud
storage), Macs and many other commercial servers and Network
Attached Storage appliances as well as by the popular Open
Source server Samba.</p>


<p style="margin-left:9%; margin-top: 1em"><b>mount.smb3</b>
mounts only SMB3 filesystem. It is usually invoked
indirectly by the mount(8) command when using the
&quot;&minus;t smb3&quot; option. The <b>smb3</b> filesystem
type was added in kernel&minus;4.18 and above. It works in a
similar fashion as mount.cifs except it passes filesystem
type as smb3.</p>

<p style="margin-left:9%; margin-top: 1em">The mount.cifs
utility attaches the UNC name (exported network resource)
specified as service (using <b>//server/share</b> syntax,
where &quot;server&quot; is the server name or IP address
and &quot;share&quot; is the name of the share) to the local
directory mount&minus;point.</p>

<p style="margin-left:9%; margin-top: 1em">Options to
mount.cifs are specified as a comma&minus;separated list of
<b>key=value</b> pairs. It is possible to send options other
than those listed here, assuming that the cifs filesystem
kernel module (<b>cifs.ko</b>) supports them. Unrecognized
cifs mount options passed to the cifs vfs kernel code will
be logged to the kernel log.</p>


<p style="margin-left:9%; margin-top: 1em"><b>mount.cifs</b>
causes the cifs vfs to launch a thread named cifsd. After
mounting it keeps running until the mounted resource is
unmounted (usually via the <b>umount</b> utility).</p>

<p style="margin-left:9%; margin-top: 1em"><b>mount.cifs
&minus;V</b> command displays the version of cifs mount
helper.</p>

<p style="margin-left:9%; margin-top: 1em"><b>modinfo
cifs</b> command displays the version of cifs module.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Refer to
<a href="mount.html#OPTIONS">mount(8)</a> for a description of generic mount options
available for all file systems.</p>

<p style="margin-left:9%; margin-top: 1em"><b>username=arg|user=arg</b></p>

<p style="margin-left:18%;">specifies the username to
connect as. If this is not given, then the environment
variable USER is used.</p>

<p style="margin-left:18%; margin-top: 1em">Earlier
versions of mount.cifs also allowed one to specify the
username in a <b>user%password</b> or <b>workgroup/user</b>
or <b>workgroup/user%password</b> to allow the password and
workgroup to be specified as part of the username. Support
for those alternate username formats is now deprecated and
should no longer be used. Users should use the discrete
<b>password=</b> and <b>domain=</b> to specify those values.
While some versions of the cifs kernel module accept
<b>user=</b> as an abbreviation for this option, its use can
confuse the standard mount program into thinking that this
is a non&minus;superuser mount. It is therefore recommended
to use the full <b>username=</b> option name.</p>


<p style="margin-left:9%;"><b>password=arg|pass=arg</b></p>

<p style="margin-left:18%;">specifies the CIFS password. If
this option is not given then the environment variable
PASSWD is used. If the password is not specified directly or
indirectly via an argument to mount, mount.cifs will prompt
for a password, unless the guest option is specified.</p>

<p style="margin-left:18%; margin-top: 1em">Note that a
password which contains the delimiter character (i.e. a
comma ',') will fail to be parsed correctly on the command
line. However, the same password defined in the PASSWD
environment variable or via a credentials file (see below)
or entered at the password prompt will be read
correctly.</p>


<p style="margin-left:9%;"><b>credentials=filename|cred=filename</b></p>

<p style="margin-left:18%;">specifies a file that contains
a username and/or password and optionally the name of the
workgroup. The format of the file is:</p>

<pre style="margin-left:22%; margin-top: 1em">username=value
password=value
domain=value</pre>


<p style="margin-left:18%; margin-top: 1em">This is
preferred over having passwords in plaintext in a shared
file, such as <i>/etc/fstab</i> . Be sure to protect any
credentials file properly.</p>

<p style="margin-left:9%;"><b>uid=arg</b></p>

<p style="margin-left:18%;">sets the uid that will own all
files or directories on the mounted filesystem when the
server does not provide ownership information. It may be
specified as either a username or a numeric uid. When not
specified, the default is uid 0. The mount.cifs helper must
be at version 1.10 or higher to support specifying the uid
in non&minus;numeric form. See the section on <i>FILE AND
DIRECTORY OWNERSHIP AND PERMISSIONS</i> below for more
information.</p>

<p style="margin-left:9%;"><b>forceuid</b></p>

<p style="margin-left:18%;">instructs the client to ignore
any uid provided by the server for files and directories and
to always assign the owner to be the value of the uid=
option. See the section on <i>FILE AND DIRECTORY OWNERSHIP
AND PERMISSIONS</i> below for more information.</p>

<p style="margin-left:9%;"><b>cruid=arg</b></p>

<p style="margin-left:18%;">sets the uid of the owner of
the credentials cache. This is primarily useful with
<b>sec=krb5</b>. The default is the real uid of the process
performing the mount. Setting this parameter directs the
upcall to look for a credentials cache owned by that
user.</p>

<p style="margin-left:9%;"><b>gid=arg</b></p>

<p style="margin-left:18%;">sets the gid that will own all
files or directories on the mounted filesystem when the
server does not provide ownership information. It may be
specified as either a groupname or a numeric gid. When not
specified, the default is gid 0. The mount.cifs helper must
be at version 1.10 or higher to support specifying the gid
in non&minus;numeric form. See the section on <i>FILE AND
DIRECTORY OWNERSHIP AND PERMISSIONS</i> below for more
information.</p>

<p style="margin-left:9%;"><b>forcegid</b></p>

<p style="margin-left:18%;">instructs the client to ignore
any gid provided by the server for files and directories and
to always assign the owner to be the value of the gid=
option. See the section on <i>FILE AND DIRECTORY OWNERSHIP
AND PERMISSIONS</i> below for more information.</p>

<p style="margin-left:9%;"><b>idsfromsid</b></p>

<p style="margin-left:18%;">Extract uid/gid from special
SID instead of mapping it. See the section on <i>FILE AND
DIRECTORY OWNERSHIP AND PERMISSIONS</i> below for more
information.</p>

<p style="margin-left:9%;"><b>port=arg</b></p>

<p style="margin-left:18%;">sets the port number on which
the client will attempt to contact the CIFS server. If this
value is specified, look for an existing connection with
this port, and use that if one exists. If one doesn't exist,
try to create a new connection on that port. If that
connection fails, return an error. If this value isn't
specified, look for an existing connection on port 445 or
139. If no such connection exists, try to connect on port
445 first and then port 139 if that fails. Return an error
if both fail.</p>

<p style="margin-left:9%;"><b>netbiosname=arg</b></p>

<p style="margin-left:18%;">When mounting to servers via
port 139, specifies the RFC1001 source name to use to
represent the client netbios machine during the netbios
session initialization.</p>

<p style="margin-left:9%;"><b>servern=arg</b></p>

<p style="margin-left:18%;">Similar to <b>netbiosname</b>
except it specifies the netbios name of the server instead
of the client. Although rarely needed for mounting to newer
servers, this option is needed for mounting to some older
servers (such as OS/2 or Windows 98 and Windows ME) since
when connecting over port 139 they, unlike most newer
servers, do not support a default server name. A server name
can be up to 15 characters long and is usually
uppercased.</p>

<p style="margin-left:9%;"><b>file_mode=arg</b></p>

<p style="margin-left:18%;">If the server does not support
the CIFS Unix extensions this overrides the default file
mode.</p>

<p style="margin-left:9%;"><b>dir_mode=arg</b></p>

<p style="margin-left:18%;">If the server does not support
the CIFS Unix extensions this overrides the default mode for
directories.</p>

<p style="margin-left:9%;"><b>ip=arg|addr=arg</b></p>

<p style="margin-left:18%;">sets the destination IP
address. This option is set automatically if the server name
portion of the requested UNC name can be resolved so rarely
needs to be specified by the user.</p>


<p style="margin-left:9%;"><b>domain=arg|dom=arg|workgroup=arg</b></p>

<p style="margin-left:18%;">Sets the domain (workgroup) of
the user. If no domains are given, the empty domain will be
used. Use <b>domainauto</b> to automatically guess the
domain of the server you are connecting to.</p>

<p style="margin-left:9%;"><b>domainauto</b></p>

<p style="margin-left:18%;">When using NTLM authentication
and not providing a domain via <b>domain</b>, guess the
domain from the server NTLM challenge. This behavior used to
be the default on kernels older than 2.6.36.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="6%">


<p><b>guest</b></p></td>
<td width="3%"></td>
<td width="36%">


<p>don't prompt for a password.</p></td>
<td width="46%">
</td></tr>
</table>

<p style="margin-left:9%;"><b>iocharset</b></p>

<p style="margin-left:18%;">Charset used to convert local
path names to and from Unicode. Unicode is used by default
for network path names if the server supports it. If
<b>iocharset</b> is not specified then the
<b>nls_default</b> specified during the local client kernel
build will be used. If server does not support Unicode, this
parameter is unused.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p><b>ro</b></p></td>
<td width="6%"></td>
<td width="22%">


<p>mount read&minus;only.</p></td>
<td width="60%">
</td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p><b>rw</b></p></td>
<td width="6%"></td>
<td width="22%">


<p>mount read&minus;write.</p></td>
<td width="60%">
</td></tr>
</table>

<p style="margin-left:9%;"><b>setuids</b></p>

<p style="margin-left:18%;">If the CIFS Unix extensions are
negotiated with the server the client will attempt to set
the effective uid and gid of the local process on newly
created files, directories, and devices (create, mkdir,
mknod). If the CIFS Unix Extensions are not negotiated, for
newly created files and directories instead of using the
default uid and gid specified on the the mount, cache the
new file's uid and gid locally which means that the uid for
the file can change when the inode is reloaded (or the user
remounts the share).</p>

<p style="margin-left:9%;"><b>nosetuids</b></p>

<p style="margin-left:18%;">The client will not attempt to
set the uid and gid on on newly created files, directories,
and devices (create, mkdir, mknod) which will result in the
server setting the uid and gid to the default (usually the
server uid of the user who mounted the share). Letting the
server (rather than the client) set the uid and gid is the
default. If the CIFS Unix Extensions are not negotiated then
the uid and gid for new files will appear to be the uid
(gid) of the mounter or the uid (gid) parameter specified on
the mount.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="8%">


<p><b>perm</b></p></td>
<td width="1%"></td>
<td width="82%">


<p>Client does permission checks (vfs_permission check of
uid and gid of the file against the mode and desired
operation), Note that this is in addition to the normal ACL
check on the target machine done by the server software.
Client permission checking is enabled by default.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="8%">


<p><b>noperm</b></p></td>
<td width="1%"></td>
<td width="82%">


<p>Client does not do permission checks. This can expose
files on this mount to access by other users on the local
client system. It is typically only needed when the server
supports the CIFS Unix Extensions but the UIDs/GIDs on the
client and server system do not match closely enough to
allow access by the user doing the mount. Note that this
does not affect the normal ACL check on the target machine
done by the server software (of the server ACL against the
user name provided at mount time).</p></td></tr>
</table>

<p style="margin-left:9%;"><b>dynperm</b></p>

<p style="margin-left:18%;">Instructs the server to
maintain ownership and permissions in memory that can't be
stored on the server. This information can disappear at any
time (whenever the inode is flushed from the cache), so
while this may help make some applications work, it's
behavior is somewhat unreliable. See the section below on
<i>FILE AND DIRECTORY OWNERSHIP AND PERMISSIONS</i> for more
information.</p>

<p style="margin-left:9%;"><b>cache=arg</b></p>

<p style="margin-left:18%;">Cache mode. See the section
below on <i>CACHE COHERENCY</i> for details. Allowed values
are:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="60%">


<p><b>none</b> &minus; do not cache file data at all</p></td>
<td width="19%">
</td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="60%">


<p><b>strict</b> &minus; follow the CIFS/SMB2 protocol
strictly</p> </td>
<td width="19%">
</td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="60%">


<p><b>loose</b> &minus; allow loose caching semantics</p></td>
<td width="19%">
</td></tr>
</table>

<p style="margin-left:18%; margin-top: 1em">The default in
kernels prior to 3.7 was <b>loose</b>. As of kernel 3.7 the
default is <b>strict</b>.</p>

<p style="margin-left:9%;"><b>nostrictsync</b></p>

<p style="margin-left:18%;">Do not ask the server to flush
on fsync(). Some servers perform non&minus;buffered writes
by default in which case flushing is redundant. In workloads
where a client is performing a lot of small write + fsync
combinations and where network latency is much higher than
the server latency, this brings a 2x performance
improvement. This option is also a good candidate in
scenarios where we want performance over consistency.</p>

<p style="margin-left:9%;"><b>handlecache</b></p>

<p style="margin-left:18%;">(default) In SMB2 and above,
the client often has to open the root of the share (empty
path) in various places during mount, path revalidation and
the statfs(2) system call. This option cuts redundant round
trip traffic (opens and closes) by simply keeping the
directory handle for the root around once opened.</p>

<p style="margin-left:9%;"><b>nohandlecache</b></p>

<p style="margin-left:18%;">Disable caching of the share
root directory handle.</p>

<p style="margin-left:9%;"><b>handletimeout=arg</b></p>

<p style="margin-left:18%;">The time (in milliseconds) for
which the server should reserve the handle after a failover
waiting for the client to reconnect. When mounting with
resilienthandles or persistenthandles mount option, or when
their use is requested by the server (continuous
availability shares) then this parameter overrides the
server default handle timeout (which for most servers is 120
seconds).</p>

<p style="margin-left:9%;"><b>rwpidforward</b></p>

<p style="margin-left:18%;">Forward pid of a process who
opened a file to any read or write operation on that file.
This prevent applications like wine(1) from failing on read
and write if we use mandatory brlock style.</p>

<p style="margin-left:9%;"><b>mapchars</b></p>

<p style="margin-left:18%;">Translate six of the seven
reserved characters (not backslash, but including the colon,
question mark, pipe, asterik, greater than and less than
characters) to the remap range (above 0xF000), which also
allows the CIFS client to recognize files created with such
characters by Windows's Services for Mac. This can also be
useful when mounting to most versions of Samba (which also
forbids creating and opening files whose names contain any
of these seven characters). This has no effect if the server
does not support Unicode on the wire. Please note that the
files created with <b>mapchars</b> mount option may not be
accessible if the share is mounted without that option.</p>

<p style="margin-left:9%;"><b>nomapchars</b></p>

<p style="margin-left:18%;">(default) Do not translate any
of these seven characters.</p>

<p style="margin-left:9%;"><b>mapposix</b></p>

<p style="margin-left:18%;">Translate reserved characters
similarly to <b>mapchars</b> but use the mapping from
Microsoft &quot;Services For Unix&quot;.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="8%">


<p><b>intr</b></p></td>
<td width="1%"></td>
<td width="82%">


<p>currently unimplemented.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="8%">


<p><b>nointr</b></p></td>
<td width="1%"></td>
<td width="82%">


<p>(default) currently unimplemented.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="8%">


<p><b>hard</b></p></td>
<td width="1%"></td>
<td width="82%">


<p>The program accessing a file on the cifs mounted file
system will hang when the server crashes.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="8%">


<p><b>soft</b></p></td>
<td width="1%"></td>
<td width="82%">


<p>(default) The program accessing a file on the cifs
mounted file system will not hang when the server crashes
and will return errors to the user application.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="8%">


<p><b>noacl</b></p></td>
<td width="1%"></td>
<td width="82%">


<p>Do not allow POSIX ACL operations even if server would
support them.</p></td></tr>
</table>

<p style="margin-left:18%; margin-top: 1em">The CIFS client
can get and set POSIX ACLs (getfacl, setfacl) to Samba
servers version 3.0.10 and later. Setting POSIX ACLs
requires enabling both <b>CIFS_XATTR</b> and then
<b>CIFS_POSIX</b> support in the CIFS configuration options
when building the cifs module. POSIX ACL support can be
disabled on a per mount basis by specifying <b>noacl</b> on
mount.</p>

<p style="margin-left:9%;"><b>cifsacl</b></p>

<p style="margin-left:18%;">This option is used to map
CIFS/NTFS ACLs to/from Linux permission bits, map SIDs
to/from UIDs and GIDs, and get and set Security
Descriptors.</p>

<p style="margin-left:18%; margin-top: 1em">See section on
<i>CIFS/NTFS ACL, SID/UID/GID MAPPING, SECURITY
DESCRIPTORS</i> for more information.</p>

<p style="margin-left:9%;"><b>backupuid=arg</b></p>

<p style="margin-left:18%;">File access by this user shall
be done with the backup intent flag set. Either a name or an
id must be provided as an argument, there are no default
values.</p>

<p style="margin-left:18%; margin-top: 1em">See section
<i>ACCESSING FILES WITH BACKUP INTENT</i> for more
details.</p>

<p style="margin-left:9%;"><b>backupgid=arg</b></p>

<p style="margin-left:18%;">File access by users who are
members of this group shall be done with the backup intent
flag set. Either a name or an id must be provided as an
argument, there are no default values.</p>

<p style="margin-left:18%; margin-top: 1em">See section
<i>ACCESSING FILES WITH BACKUP INTENT</i> for more
details.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="8%">


<p><b>nocase</b></p></td>
<td width="1%"></td>
<td width="82%">


<p>Request case insensitive path name matching (case
sensitive is the default if the server supports it).</p></td></tr>
</table>

<p style="margin-left:9%;"><b>ignorecase</b></p>

<p style="margin-left:18%;">Synonym for <b>nocase</b>.</p>

<p style="margin-left:9%;"><b>sec=arg</b></p>

<p style="margin-left:18%;">Security mode. Allowed values
are:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="79%">


<p><b>none</b> &minus; attempt to connection as a null user
(no name)</p></td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="79%">


<p><b>krb5</b> &minus; Use Kerberos version 5
authentication</p> </td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="79%">


<p><b>krb5i</b> &minus; Use Kerberos authentication and
forcibly enable packet signing</p></td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="79%">


<p><b>ntlm</b> &minus; Use NTLM password hashing</p></td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="79%">


<p><b>ntlmi</b> &minus; Use NTLM password hashing and force
packet signing</p></td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="79%">


<p><b>ntlmv2</b> &minus; Use NTLMv2 password hashing</p></td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="79%">


<p><b>ntlmv2i</b> &minus; Use NTLMv2 password hashing and
force packet signing</p></td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="79%">


<p><b>ntlmssp</b> &minus; Use NTLMv2 password hashing
encapsulated in Raw NTLMSSP message</p></td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="79%">


<p><b>ntlmsspi</b> &minus; Use NTLMv2 password hashing
encapsulated in Raw NTLMSSP message, and force packet
signing</p> </td></tr>
</table>

<p style="margin-left:18%; margin-top: 1em">The default in
mainline kernel versions prior to v3.8 was <b>sec=ntlm</b>.
In v3.8, the default was changed to <b>sec=ntlmssp</b>.</p>

<p style="margin-left:18%; margin-top: 1em">If the server
requires signing during protocol negotiation, then it may be
enabled automatically. Packet signing may also be enabled
automatically if it's enabled in
<i>/proc/fs/cifs/SecurityFlags</i>.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="5%">


<p style="margin-top: 1em"><b>seal</b></p></td>
<td width="4%"></td>
<td width="82%">


<p style="margin-top: 1em">Request encryption at the SMB
layer. The encryption algorithm used is
AES&minus;128&minus;CCM. Requires SMB3 or above (see
<b>vers</b>).</p> </td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="5%">


<p><b>rdma</b></p></td>
<td width="4%"></td>
<td width="82%">


<p>Connect directly to the server using SMB Direct via a
RDMA adapter. Requires SMB3 or above (see <b>vers</b>).</p></td></tr>
</table>

<p style="margin-left:9%;"><b>resilienthandles</b></p>

<p style="margin-left:18%;">Enable resilient handles. If
the server supports it, keep opened files across
reconnections. Requires SMB2.1 (see <b>vers</b>).</p>

<p style="margin-left:9%;"><b>noresilienthandles</b></p>

<p style="margin-left:18%;">(default) Disable resilient
handles.</p>

<p style="margin-left:9%;"><b>persistenthandles</b></p>

<p style="margin-left:18%;">Enable persistent handles. If
the server supports it, keep opened files across
reconnections. Persistent handles are also valid across
servers in a cluster and have stronger guarantees than
resilient handles. Requires SMB3 or above (see
<b>vers</b>).</p>

<p style="margin-left:9%;"><b>nopersistenthandles</b></p>

<p style="margin-left:18%;">(default) Disable persistent
handles.</p>

<p style="margin-left:9%;"><b>snapshot=time</b></p>

<p style="margin-left:18%;">Mount a specific snapshot of
the remote share. <b>time</b> must be a positive integer
identifying the snapshot requested (in 100&minus;nanosecond
units that have elapsed since January 1, 1601, or
alternatively it can be specified in GMT format e.g.
@GMT&minus;2019.03.27&minus;20.52.19). Supported in the
Linux kernel starting from v4.19.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="6%">


<p><b>nobrl</b></p></td>
<td width="3%"></td>
<td width="82%">


<p>Do not send byte range lock requests to the server. This
is necessary for certain applications that break with cifs
style mandatory byte range locks (and most cifs servers do
not yet support requesting advisory byte range locks).</p></td></tr>
</table>

<p style="margin-left:9%;"><b>forcemandatorylock</b></p>

<p style="margin-left:18%;">Do not use POSIX locks even
when available via unix extensions. Always use cifs style
mandatory locks.</p>

<p style="margin-left:9%;"><b>locallease</b></p>

<p style="margin-left:18%;">Check cached leases locally
instead of querying the server.</p>

<p style="margin-left:9%;"><b>nolease</b></p>

<p style="margin-left:18%;">Do not request lease/oplock
when openning a file on the server. This turns off local
caching of IO, byte&minus;range lock and read metadata
operations (see <b>actimeo</b> for more details about
metadata caching). Requires SMB2 and above (see
<b>vers</b>).</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="4%">


<p><b>sfu</b></p></td>
<td width="5%"></td>
<td width="82%">


<p>When the CIFS or SMB3 Unix Extensions are not
negotiated, attempt to create device files and fifos in a
format compatible with Services for Unix (SFU). In addition
retrieve bits 10&minus;12 of the mode via the
<b>SETFILEBITS</b> extended attribute (as SFU does). In the
future the bottom 9 bits of the mode mode also will be
emulated using queries of the security descriptor (ACL).
[NB: requires version 1.39 or later of the CIFS VFS. To
recognize symlinks and be able to create symlinks in an SFU
interoperable form requires version 1.40 or later of the
CIFS VFS kernel module.</p></td></tr>
</table>

<p style="margin-left:9%;"><b>mfsymlinks</b></p>

<p style="margin-left:18%;">Enable support for
Minshall+French symlinks (see
<i>http://wiki.samba.org/index.php/UNIX_Extensions#Minshall.2BFrench_symlinks</i>).
This option is ignored when specified together with the
<b>sfu</b> option. Minshall+French symlinks are used even if
the server supports the CIFS Unix Extensions.</p>

<p style="margin-left:9%;"><b>echo_interval=n</b></p>

<p style="margin-left:18%;">sets the interval at which echo
requests are sent to the server on an idling connection.
This setting also affects the time required for a connection
to an unresponsive server to timeout. Here n is the echo
interval in seconds. The reconnection happens at twice the
value of the echo_interval set for an unresponsive server.
If this option is not given then the default value of 60
seconds is used. The minimum tunable value is 1 second and
maximum can go up to 600 seconds.</p>

<p style="margin-left:9%;"><b>serverino</b></p>

<p style="margin-left:18%;">Use inode numbers (unique
persistent file identifiers) returned by the server instead
of automatically generating temporary inode numbers on the
client. Although server inode numbers make it easier to spot
hardlinked files (as they will have the same inode numbers)
and inode numbers may be persistent (which is useful for
some software), the server does not guarantee that the inode
numbers are unique if multiple server side mounts are
exported under a single share (since inode numbers on the
servers might not be unique if multiple filesystems are
mounted under the same shared higher level directory). Note
that not all servers support returning server inode numbers,
although those that support the CIFS Unix Extensions, and
Windows 2000 and later servers typically do support this
(although not necessarily on every local server filesystem).
Parameter has no effect if the server lacks support for
returning inode numbers or equivalent. This behavior is
enabled by default.</p>

<p style="margin-left:9%;"><b>noserverino</b></p>

<p style="margin-left:18%;">Client generates inode numbers
itself rather than using the actual ones from the
server.</p>

<p style="margin-left:18%; margin-top: 1em">See section
<i>INODE NUMBERS</i> for more information.</p>

<p style="margin-left:9%;"><b>posix|unix|linux</b></p>

<p style="margin-left:18%;">(default) Enable Unix
Extensions for this mount. Requires CIFS (vers=1.0) or
SMB3.1.1 (vers=3.1.1) and a server supporting them.</p>


<p style="margin-left:9%;"><b>noposix|nounix|nolinux</b></p>

<p style="margin-left:18%;">Disable the Unix Extensions for
this mount. This can be useful in order to turn off multiple
settings at once. This includes POSIX acls, POSIX locks,
POSIX paths, symlink support and retrieving uids/gids/mode
from the server. This can also be useful to work around a
bug in a server that supports Unix Extensions.</p>

<p style="margin-left:18%; margin-top: 1em">See section
<i>INODE NUMBERS</i> for more information.</p>

<p style="margin-left:9%;"><b>nouser_xattr</b></p>

<p style="margin-left:18%;">Do not allow getfattr/setfattr
to get/set xattrs, even if server would support it
otherwise. The default is for xattr support to be
enabled.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="6%">


<p><b>nodfs</b></p></td>
<td width="3%"></td>
<td width="82%">


<p>Do not follow Distributed FileSystem referrals. IO on a
file not stored on the server will fail instead of
connecting to the target server transparently.</p></td></tr>
</table>

<p style="margin-left:9%;"><b>noautotune</b></p>

<p style="margin-left:18%;">Use fixed size for kernel
recv/send socket buffers.</p>

<p style="margin-left:9%;"><b>nosharesock</b></p>

<p style="margin-left:18%;">Do not try to reuse sockets if
the system is already connected to the server via an
existing mount point. This will make the client always make
a new connection to the server no matter what he is already
connected to. This can be useful in simulating multiple
clients connecting to the same server, as each mount point
will use a different TCP socket.</p>

<p style="margin-left:9%;"><b>noblocksend</b></p>

<p style="margin-left:18%;">Send data on the socket using
non blocking operations (MSG_DONTWAIT flag).</p>

<p style="margin-left:9%;"><b>rsize=bytes</b></p>

<p style="margin-left:18%;">Maximum amount of data that the
kernel will request in a read request in bytes. Maximum size
that servers will accept is typically 8MB for SMB3 or later
dialects. Default requested during mount is 4MB. Prior to
the 4.20 kernel the default requested was 1MB. Prior to the
SMB2.1 dialect the maximum was usually 64K.</p>

<p style="margin-left:9%;"><b>wsize=bytes</b></p>

<p style="margin-left:18%;">Maximum amount of data that the
kernel will send in a write request in bytes. Maximum size
that servers will accept is typically 8MB for SMB3 or later
dialects. Default requested during mount is 4MB. Prior to
the 4.20 kernel the default requested was 1MB. Prior to the
SMB2.1 dialect the maximum was usually 64K.</p>

<p style="margin-left:9%;"><b>bsize=bytes</b></p>

<p style="margin-left:18%;">Override the default blocksize
(1MB) reported on SMB3 files (requires kernel version of 5.1
or later). Prior to kernel version 5.1, the blocksize was
always reported as 16K instead of 1MB (and was not
configurable) which can hurt the performance of tools like
cp and scp (especially for uncached I/O) which decide on the
read and write size to use for file copies based on the
inode blocksize. bsize may not be less than 16K or greater
than 16M.</p>

<p style="margin-left:9%;"><b>max_credits=n</b></p>

<p style="margin-left:18%;">Maximum credits the SMB2 client
can have. Default is 32000. Must be set to a number between
20 and 60000.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="4%">


<p><b>fsc</b></p></td>
<td width="5%"></td>
<td width="82%">


<p>Enable local disk caching using FS&minus;Cache for CIFS.
This option could be useful to improve performance on a slow
link, heavily loaded server and/or network where reading
from the disk is faster than reading from the server (over
the network). This could also impact the scalability
positively as the number of calls to the server are reduced.
But, be warned that local caching is not suitable for all
workloads, for e.g., read&minus;once type workloads. So, you
need to consider carefully the situation/workload before
using this option. Currently, local disk caching is enabled
for CIFS files opened as read&minus;only.</p></td></tr>
</table>

<p style="margin-left:18%; margin-top: 1em"><b>NOTE</b>:
This feature is available only in the recent kernels that
have been built with the kernel config option
<b>CONFIG_CIFS_FSCACHE</b>. You also need to have
<b>cachefilesd</b> daemon installed and running to make the
cache operational.</p>

<p style="margin-left:9%;"><b>multiuser</b></p>

<p style="margin-left:18%;">Map user accesses to individual
credentials when accessing the server. By default, CIFS
mounts only use a single set of user credentials (the mount
credentials) when accessing a share. With this option, the
client instead creates a new session with the server using
the user's credentials whenever a new user accesses the
mount. Further accesses by that user will also use those
credentials. Because the kernel cannot prompt for passwords,
multiuser mounts are limited to mounts using <b>sec=</b>
options that don't require passwords.</p>

<p style="margin-left:18%; margin-top: 1em">With this
change, it's feasible for the server to handle permissions
enforcement, so this option also implies <b>noperm</b> .
Furthermore, when unix extensions aren't in use and the
administrator has not overridden ownership using the
<b>uid=</b> or <b>gid=</b> options, ownership of files is
presented as the current user accessing the share.</p>

<p style="margin-left:9%;"><b>actimeo=arg</b></p>

<p style="margin-left:18%;">The time (in seconds) that the
CIFS client caches attributes of a file or directory before
it requests attribute information from a server. During this
period the changes that occur on the server remain
undetected until the client checks the server again.</p>

<p style="margin-left:18%; margin-top: 1em">By default, the
attribute cache timeout is set to 1 second. This means more
frequent on&minus;the&minus;wire calls to the server to
check whether attributes have changed which could impact
performance. With this option users can make a tradeoff
between performance and cache metadata correctness,
depending on workload needs. Shorter timeouts mean better
cache coherency, but frequent increased number of calls to
the server. Longer timeouts mean a reduced number of calls
to the server but looser cache coherency. The <b>actimeo</b>
value is a positive integer that can hold values between 0
and a maximum value of 2&#710;30 * HZ (frequency of timer
interrupt) setting.</p>

<p style="margin-left:9%;"><b>noposixpaths</b></p>

<p style="margin-left:18%;">If unix extensions are enabled
on a share, then the client will typically allow filenames
to include any character besides '/' in a pathname
component, and will use forward slashes as a pathname
delimiter. This option prevents the client from attempting
to negotiate the use of posix&minus;style pathnames to the
server.</p>

<p style="margin-left:9%;"><b>posixpaths</b></p>

<p style="margin-left:18%;">Inverse of <b>noposixpaths</b>
.</p>

<p style="margin-left:9%;"><b>vers=arg</b></p>

<p style="margin-left:18%;">SMB protocol version. Allowed
values are:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="79%">


<p>1.0 &minus; The classic CIFS/SMBv1 protocol.</p></td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="79%">


<p>2.0 &minus; The SMBv2.002 protocol. This was initially
introduced in Windows Vista Service Pack 1, and Windows
Server 2008. Note that the initial release version of
Windows Vista spoke a slightly different dialect (2.000)
that is not supported.</p></td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="79%">


<p>2.1 &minus; The SMBv2.1 protocol that was introduced in
Microsoft Windows 7 and Windows Server 2008R2.</p></td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="79%">


<p>3.0 &minus; The SMBv3.0 protocol that was introduced in
Microsoft Windows 8 and Windows Server 2012.</p></td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="79%">


<p>3.02 or 3.0.2 &minus; The SMBv3.0.2 protocol that was
introduced in Microsoft Windows 8.1 and Windows Server
2012R2.</p> </td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="79%">


<p>3.1.1 or 3.11 &minus; The SMBv3.1.1 protocol that was
introduced in Microsoft Windows 10 and Windows Server
2016.</p> </td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="79%">


<p>3 &minus; The SMBv3.0 protocol version and above.</p></td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="79%">


<p>default &minus; Tries to negotiate the highest SMB2+
version supported by both the client and server.</p></td></tr>
</table>

<p style="margin-left:18%; margin-top: 1em">If no dialect
is specified on mount vers=default is used. To check
<b>Dialect</b> refer to /proc/fs/cifs/DebugData</p>

<p style="margin-left:18%; margin-top: 1em">Note too that
while this option governs the protocol version used, not all
features of each version are available.</p>

<p style="margin-left:18%; margin-top: 1em">The default
since v4.13.5 is for the client and server to negotiate the
highest possible version greater than or equal to
<b>2.1</b>. In kernels prior to v4.13, the default was
<b>1.0</b>. For kernels between v4.13 and v4.13.5 the
default is <b>3.0</b>.</p>


<p style="margin-left:9%;"><b>&minus;&minus;verbose</b></p>

<p style="margin-left:18%;">Print additional debugging
information for the mount. Note that this parameter must be
specified before the <b>&minus;o</b> . For example:</p>

<pre style="margin-left:22%; margin-top: 1em">mount &minus;t cifs //server/share /mnt &minus;&minus;verbose &minus;o user=username</pre>


<h2>SERVICE FORMATTING AND DELIMITERS
<a name="SERVICE FORMATTING AND DELIMITERS"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">It's generally
preferred to use forward slashes (/) as a delimiter in
service names. They are considered to be the &quot;universal
delimiter&quot; since they are generally not allowed to be
embedded within path components on Windows machines and the
client can convert them to backslashes (\) unconditionally.
Conversely, backslash characters are allowed by POSIX to be
part of a path component, and can't be automatically
converted in the same way.</p>


<p style="margin-left:9%; margin-top: 1em"><b>mount.cifs</b>
will attempt to convert backslashes to forward slashes where
it's able to do so, but it cannot do so in any path
component following the sharename.</p>

<h2>INODE NUMBERS
<a name="INODE NUMBERS"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">When Unix
Extensions are enabled, we use the actual inode number
provided by the server in response to the POSIX calls as an
inode number.</p>

<p style="margin-left:9%; margin-top: 1em">When Unix
Extensions are disabled and <b>serverino</b> mount option is
enabled there is no way to get the server inode number. The
client typically maps the server&minus;assigned
<b>UniqueID</b> onto an inode number.</p>

<p style="margin-left:9%; margin-top: 1em">Note that the
<b>UniqueID</b> is a different value from the server inode
number. The <b>UniqueID</b> value is unique over the scope
of the entire server and is often greater than 2 power 32.
This value often makes programs that are not compiled with
LFS (Large File Support), to trigger a glibc
<b>EOVERFLOW</b> error as this won't fit in the target
structure field. It is strongly recommended to compile your
programs with LFS support (i.e. with
<b>&minus;D_FILE_OFFSET_BITS=64</b>) to prevent this
problem. You can also use <b>noserverino</b> mount option to
generate inode numbers smaller than 2 power 32 on the
client. But you may not be able to detect hardlinks
properly.</p>

<h2>CACHE COHERENCY
<a name="CACHE COHERENCY"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">With a network
filesystem such as CIFS or NFS, the client must contend with
the fact that activity on other clients or the server could
change the contents or attributes of a file without the
client being aware of it. One way to deal with such a
problem is to mandate that all file accesses go to the
server directly. This is performance prohibitive however, so
most protocols have some mechanism to allow the client to
cache data locally.</p>

<p style="margin-left:9%; margin-top: 1em">The CIFS
protocol mandates (in effect) that the client should not
cache file data unless it holds an opportunistic lock (aka
oplock) or a lease. Both of these entities allow the client
to guarantee certain types of exclusive access to a file so
that it can access its contents without needing to
continually interact with the server. The server will call
back the client when it needs to revoke either of them and
allow the client a certain amount of time to flush any
cached data.</p>

<p style="margin-left:9%; margin-top: 1em">The cifs client
uses the kernel's pagecache to cache file data. Any I/O
that's done through the pagecache is generally
page&minus;aligned. This can be problematic when combined
with byte&minus;range locks as Windows' locking is mandatory
and can block reads and writes from occurring.</p>


<p style="margin-left:9%; margin-top: 1em"><b>cache=none</b>
means that the client never utilizes the cache for normal
reads and writes. It always accesses the server directly to
satisfy a read or write request.</p>


<p style="margin-left:9%; margin-top: 1em"><b>cache=strict</b>
means that the client will attempt to follow the CIFS/SMB2
protocol strictly. That is, the cache is only trusted when
the client holds an oplock. When the client does not hold an
oplock, then the client bypasses the cache and accesses the
server directly to satisfy a read or write request. By doing
this, the client avoids problems with byte range locks.
Additionally, byte range locks are cached on the client when
it holds an oplock and are &quot;pushed&quot; to the server
when that oplock is recalled.</p>


<p style="margin-left:9%; margin-top: 1em"><b>cache=loose</b>
allows the client to use looser protocol semantics which can
sometimes provide better performance at the expense of cache
coherency. File access always involves the pagecache. When
an oplock or lease is not held, then the client will attempt
to flush the cache soon after a write to a file. Note that
that flush does not necessarily occur before a write system
call returns.</p>

<p style="margin-left:9%; margin-top: 1em">In the case of a
read without holding an oplock, the client will attempt to
periodically check the attributes of the file in order to
ascertain whether it has changed and the cache might no
longer be valid. This mechanism is much like the one that
NFSv2/3 use for cache coherency, but it particularly
problematic with CIFS. Windows is quite &quot;lazy&quot;
with respect to updating the <b>LastWriteTime</b> field that
the client uses to verify this. The effect is that
<b>cache=loose</b> can cause data corruption when multiple
readers and writers are working on the same files.</p>

<p style="margin-left:9%; margin-top: 1em">Because of this,
when multiple clients are accessing the same set of files,
then <b>cache=strict</b> is recommended. That helps
eliminate problems with cache coherency by following the
CIFS/SMB2 protocols more strictly.</p>

<p style="margin-left:9%; margin-top: 1em">Note too that no
matter what caching model is used, the client will always
use the pagecache to handle mmap'ed files. Writes to mmap'ed
files are only guaranteed to be flushed to the server when
msync() is called, or on close().</p>

<p style="margin-left:9%; margin-top: 1em">The default in
kernels prior to 3.7 was <b>loose</b>. As of 3.7, the
default is <b>strict</b>.</p>

<h2>CIFS/NTFS ACL, SID/UID/GID MAPPING, SECURITY DESCRIPTORS
<a name="CIFS/NTFS ACL, SID/UID/GID MAPPING, SECURITY DESCRIPTORS"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">This option is
used to work with file objects which posses Security
Descriptors and CIFS/NTFS ACL instead of UID, GID, file
permission bits, and POSIX ACL as user authentication model.
This is the most common authentication model for CIFS
servers and is the one used by Windows.</p>

<p style="margin-left:9%; margin-top: 1em">Support for this
requires both CIFS_XATTR and CIFS_ACL support in the CIFS
configuration options when building the cifs module.</p>

<p style="margin-left:9%; margin-top: 1em">A CIFS/NTFS ACL
is mapped to file permission bits using an algorithm
specified in the following Microsoft TechNet document:</p>


<p style="margin-left:9%; margin-top: 1em"><i>http://technet.microsoft.com/en&minus;us/library/bb463216.aspx</i></p>

<p style="margin-left:9%; margin-top: 1em">In order to map
SIDs to/from UIDs and GIDs, the following is required:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="88%">


<p>a kernel upcall to the <b>cifs.idmap</b> utility set up
via request&minus;key.conf(5)</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="88%">


<p>winbind support configured via nsswitch.conf(5) and
smb.conf(5)</p> </td></tr>
</table>

<p style="margin-left:9%; margin-top: 1em">Please refer to
the respective manpages of cifs.idmap(8) and winbindd(8) for
more information.</p>

<p style="margin-left:9%; margin-top: 1em">Security
descriptors for a file object can be retrieved and set
directly using extended attribute named
<b>system.cifs_acl</b>. The security descriptors presented
via this interface are &quot;raw&quot; blobs of data and
need a userspace utility to either parse and format or to
assemble it such as getcifsacl(1) and setcifsacl(1)
respectively.</p>

<p style="margin-left:9%; margin-top: 1em">Some of the
things to consider while using this mount option:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="2%"></td>
<td width="88%">


<p style="margin-top: 1em">There may be an increased
latency when handling metadata due to additional requests to
get and set security descriptors.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="88%">


<p>The mapping between a CIFS/NTFS ACL and POSIX file
permission bits is imperfect and some ACL information may be
lost in the translation.</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="88%">


<p>If either upcall to cifs.idmap is not setup correctly or
winbind is not configured and running, ID mapping will fail.
In that case uid and gid will default to either to those
values of the share or to the values of uid and/or gid mount
options if specified.</p></td></tr>
</table>

<h2>ACCESSING FILES WITH BACKUP INTENT
<a name="ACCESSING FILES WITH BACKUP INTENT"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">For an user on
the server, desired access to a file is determined by the
permissions and rights associated with that file. This is
typically accomplished using ownership and ACL. For a user
who does not have access rights to a file, it is still
possible to access that file for a specific or a targeted
purpose by granting special rights. One of the specific
purposes is to access a file with the intent to either
backup or restore i.e. backup intent. The right to access a
file with the backup intent can typically be granted by
making that user a part of the built&minus;in group
<i>Backup Operators</i>. Thus, when this user attempts to
open a file with the backup intent, open request is sent by
setting the bit <b>FILE_OPEN_FOR_BACKUP_INTENT</b> as one of
the <b>CreateOptions</b>.</p>

<p style="margin-left:9%; margin-top: 1em">As an example,
on a Windows server, a user named <i>testuser</i>, cannot
open this file with such a security descriptor:</p>

<pre style="margin-left:13%; margin-top: 1em">REVISION:0x1
CONTROL:0x9404
OWNER:Administrator
GROUP:Domain Users
ACL:Administrator:ALLOWED/0x0/FULL</pre>


<p style="margin-left:9%; margin-top: 1em">But the user
<i>testuser</i>, if it becomes part of the <i>Backup
Operators</i> group, can open the file with the backup
intent.</p>

<p style="margin-left:9%; margin-top: 1em">Any user on the
client side who can authenticate as such a user on the
server, can access the files with the backup intent. But it
is desirable and preferable for security reasons amongst
many, to restrict this special right.</p>

<p style="margin-left:9%; margin-top: 1em">The mount option
<b>backupuid</b> is used to restrict this special right to a
user which is specified by either a name or an id. The mount
option <b>backupgid</b> is used to restrict this special
right to the users in a group which is specified by either a
name or an id. Only users matching either backupuid or
backupgid shall attempt to access files with backup intent.
These two mount options can be used together.</p>

<h2>FILE AND DIRECTORY OWNERSHIP AND PERMISSIONS
<a name="FILE AND DIRECTORY OWNERSHIP AND PERMISSIONS"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">The core CIFS
protocol does not provide unix ownership information or mode
for files and directories. Because of this, files and
directories will generally appear to be owned by whatever
values the <b>uid=</b> or <b>gid=</b> options are set, and
will have permissions set to the default <b>file_mode</b>
and <b>dir_mode</b> for the mount. Attempting to change
these values via chmod/chown will return success but have no
effect.</p>

<p style="margin-left:9%; margin-top: 1em">When the client
and server negotiate unix extensions, files and directories
will be assigned the uid, gid, and mode provided by the
server. Because CIFS mounts are generally single&minus;user,
and the same credentials are used no matter what user
accesses the mount, newly created files and directories will
generally be given ownership corresponding to whatever
credentials were used to mount the share.</p>

<p style="margin-left:9%; margin-top: 1em">If the uid's and
gid's being used do not match on the client and server, the
<b>forceuid</b> and <b>forcegid</b> options may be helpful.
Note however, that there is no corresponding option to
override the mode. Permissions assigned to a file when
<b>forceuid</b> or <b>forcegid</b> are in effect may not
reflect the the real permissions.</p>

<p style="margin-left:9%; margin-top: 1em">When unix
extensions are not negotiated, it's also possible to emulate
them locally on the server using the <b>dynperm</b> mount
option. When this mount option is in effect, newly created
files and directories will receive what appear to be proper
permissions. These permissions are not stored on the server
however and can disappear at any time in the future (subject
to the whims of the kernel flushing out the inode cache). In
general, this mount option is discouraged.</p>

<p style="margin-left:9%; margin-top: 1em">It's also
possible to override permission checking on the client
altogether via the <b>noperm</b> option. Server&minus;side
permission checks cannot be overridden. The permission
checks done by the server will always correspond to the
credentials used to mount the share, and not necessarily to
the user who is accessing the share.</p>

<h2>ENVIRONMENT VARIABLES
<a name="ENVIRONMENT VARIABLES"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">The variable
<b>USER</b> may contain the username of the person to be
used to authenticate to the server. The variable can be used
to set both username and password by using the format
<b>username%password</b>.</p>

<p style="margin-left:9%; margin-top: 1em">The variable
<b>PASSWD</b> may contain the password of the person using
the client.</p>

<p style="margin-left:9%; margin-top: 1em">The variable
<b>PASSWD_FILE</b> may contain the pathname of a file to
read the password from. A single line of input is read and
used as the password.</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">This command may
be used only by root, unless installed setuid, in which case
the noexec and nosuid mount flags are enabled. When
installed as a setuid program, the program follows the
conventions set forth by the mount program for user mounts,
with the added restriction that users must be able to
chdir() into the mountpoint prior to the mount in order to
be able to mount onto it.</p>

<p style="margin-left:9%; margin-top: 1em">Some samba
client tools like smbclient(8) honour client&minus;side
configuration parameters present in <i>smb.conf</i>. Unlike
those client tools, <b>mount.cifs</b> ignores
<i>smb.conf</i> completely.</p>

<h2>CONFIGURATION
<a name="CONFIGURATION"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">The primary
mechanism for making configuration changes and for reading
debug information for the cifs vfs is via the Linux /proc
filesystem. In the directory <i>/proc/fs/cifs</i> are
various configuration files and pseudo files which can
display debug information and performance statistics. There
are additional startup options such as maximum buffer size
and number of buffers which only may be set when the kernel
cifs vfs (cifs.ko module) is loaded. These can be seen by
running the <b>modinfo</b> utility against the file cifs.ko
which will list the options that may be passed to cifs
during module installation (device driver load). For more
information see the kernel file <i>fs/cifs/README</i>. When
configuring dynamic tracing (trace&minus;cmd) note that the
list of SMB3 events which can be enabled can be seen at:
<i>/sys/kernel/debug/tracing/events/cifs/</i>.</p>

<h2>SECURITY
<a name="SECURITY"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">The use of
SMB2.1 or later (including the latest dialect SMB3.1.1) is
recommended for improved security and SMB1 is no longer
requested by default at mount time. Old dialects such as
CIFS (SMB1, ie vers=1.0) have much weaker security. Use of
CIFS (SMB1) can be disabled by modprobe cifs
disable_legacy_dialects=y.</p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">Mounting using
the CIFS URL specification is currently not supported.</p>

<p style="margin-left:9%; margin-top: 1em">The credentials
file does not handle usernames or passwords with leading
space.</p>

<p style="margin-left:9%; margin-top: 1em">Note that the
typical response to a bug report is a suggestion to try the
latest version first. So please try doing that first, and
always include which versions you use of relevant software
when reporting bugs (minimum: mount.cifs (try <b>mount.cifs
&minus;V</b>), kernel (see <i>/proc/version</i>) and server
type you are trying to contact.</p>

<h2>VERSION
<a name="VERSION"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">This man page is
correct for version 2.18 of the cifs vfs filesystem (roughly
Linux kernel 5.0).</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">cifs.upcall(8),
getcifsacl(1), setcifsacl(1)</p>


<p style="margin-left:9%; margin-top: 1em"><i>Documentation/filesystems/cifs.txt</i>
and <i>fs/cifs/README</i> in the Linux kernel source tree
may contain additional options and information.</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">Steve French</p>

<p style="margin-left:9%; margin-top: 1em">The maintainer
of the Linux cifs vfs is Steve French. The maintainer of the
cifs&minus;utils suite of user space tools is Pavel
Shilovsky. The Linux CIFS Mailing list is the preferred
place to ask questions regarding these programs.</p>
<hr>
</body>
</html>
